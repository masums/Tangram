<html>

<script>
    function WndPage_OnPageLoaded(SourceWindow, URL) {
        if (SourceWindow == window) {
            var AppName = Tangram.AppKeyValue("appname");
            WndPage.EnableSinkCLRCtrlCreatedEvent = true;
            if (AppName == "devenv")
            {
                alert(1);
                WndPage.ExtendCtrl(0, "Default", WndPage.xtml("xtmlStartupDoc"));
            }
            else if(AppName == "excel")
            {
                WndPage.ExtendCtrl(0, "Default", WndPage.xtml("xtmlExcelToolBar"));
            }
            else if (AppName == "outlook") {
                WndPage.ExtendCtrl(0, "Default", WndPage.xtml("xtmlOutLookToolBar"));
            }
            else if (AppName == "winword") {
                WndPage.ExtendCtrl(0, "Default", WndPage.xtml("xtmlWinWordToolBar"));
            }
            else if (AppName == "powerpnt") {
                WndPage.ExtendCtrl(0, "Default", WndPage.xtml("xtmlPowerPntToolBar"));
            }
            else if (AppName == "powerpnt") {
                WndPage.ExtendCtrl(0, "Default", WndPage.xtml("xtmlPowerPntToolBar"));
            }
            else {
                WndPage.ExtendCtrl(0, "Default", WndPage.xtml("xtmlStartupDoc"));
            }
        }
    }
    function PageLoaded(SourceWindow, URL) {
        if (SourceWindow == window) {
            var AppName = Tangram.AppKeyValue("appname");
            alert(AppName);
            WndPage.EnableSinkCLRCtrlCreatedEvent = true;
            if (AppName == "devenv") {
                WndPage.ExtendCtrl(0, "Default", WndPage.xtml("xtmlStartupDoc"));
            }
            else if (AppName == "excel") {
                WndPage.ExtendCtrl(0, "Default", WndPage.xtml("xtmlExcelToolBar"));
            }
            else if (AppName == "outlook") {
                WndPage.ExtendCtrl(0, "Default", WndPage.xtml("xtmlOutLookToolBar"));
            }
            else if (AppName == "winword") {
                WndPage.ExtendCtrl(0, "Default", WndPage.xtml("xtmlWinWordToolBar"));
            }
            else if (AppName == "powerpnt") {
                WndPage.ExtendCtrl(0, "Default", WndPage.xtml("xtmlPowerPntToolBar"));
            }
            else {
                WndPage.ExtendCtrl(0, "Default", WndPage.xtml("xtmlStartupDoc"));
            }
            alert(WndPage.xtml("xtmlStartupDoc"));
        }
    }
    function WndPage_OnClrControlCreated(Node, Ctrl, CtrlName, CtrlHandle) {
        //alert(CtrlName);
    }
</script>

<body>
    <xml id="xtmlStartupDoc">
        <tangramdesignertoolbar>
            <window>
                <node id="tangramtabctrl" name="tangramtabctrl" cnnid="tangramtabbedwnd.tabbedcomponent.1" style="29">
                    <node id="splitter" name="splitter" caption="Tangram Designer" style="0" rows="2" cols="1" height="550,250," width="500," middlecolor="RGB(255,224,192)">
                        <node name="TangramToolPane1" id="TangramTabCtrl" cnnid="TangramTabbedWnd.TabbedComponent.1" style="18" activepage="0">
                            <node name="splitter" id="ClrCtrl" cnnid="TangramDesigner.SplitterDesigner,TangramCLR" caption="Create Splitter Window" />
                            <node name="howto" id="ClrCtrl" cnnid="TangramDesigner.StartupCtrl,TangramCLR" caption="Tangram Designer: How to......" />
                            <node name="hostview" id="ClrCtrl" cnnid="TangramDesigner.HostViewDesigner,TangramCLR" caption="Create Host View" />
                            <node name="tabbedwnd" id="ClrCtrl" cnnid="TangramDesigner.TabWndDesigner,TangramCLR" caption="Create Tabbed Window" />
                            <node name="axctrl" id="ClrCtrl" cnnid="TangramDesigner.AXCtrlDesigner,TangramCLR" caption="Create ActiveX Controls" />
                            <node name="clrctrl" id="ClrCtrl" cnnid="TangramDesigner.CLRCtrlDesigner,TangramCLR" caption="Create .NET Controls" />
                            <node name="cpp" id="ClrCtrl" cnnid="TangramDesigner.CppDesigner,TangramCLR" caption="C++ Components" />
                            <node name="preview" id="ClrCtrl" cnnid="TangramDesigner.PreViewCtrl,TangramCLR" caption="Preview Current XmlDoc with Application ..." />
                            <node name="TangramEditor" id="TreeView" SetHtml="1" doctype="designer" tag="designer" caption="Tangram DOM Model">
                                <TreeNode />
                            </node>
                        </node>
                        <node name="TangramToolPane2" id="TangramTabCtrl" cnnid="TangramTabbedWnd.TabbedComponent.1" style="18">
                            <node name="TangramPropertyGrid" caption="Property Editor" id="ClrCtrl" cnnid="system.windows.forms.propertygrid,tangram" />
                        </node>
                    </node>
                    <node id="splitter" name="TangramCommonDocument" caption="Tangram Common Document" rows="2" cols="1" height="350,250," width="500," middlecolor="RGB(255,224,192)">
                        <node name="TangramTemplate" id="TangramTabCtrl" cnnid="TangramTabbedWnd.TabbedComponent.1" tabstyle="18">
                            <node name="TangramList" id="TangramListView" caption="Create New Document"></node>
                        </node>
                        <node name="TangramToolPane2" id="TangramTabCtrl" cnnid="TangramTabbedWnd.TabbedComponent.1" tabstyle="18">
                            <node name="DocumentTemplate" id="TabCtrl" caption="DocumentTemplate" cnnid="" relationnode="TangramList"></node>
                        </node>
                    </node>
                    <node name="winform" caption="Tangram for WinForm Developer" id="ClrCtrl" cnnid="tangramdotnetlib.TangramforClr, tangramdotnetlib, version=1.0.0.0, culture=neutral, publickeytoken=90f9467f8999d660" />
                    <node name="mfc" caption="Tangram for MFC/C++ Developer" id="ActiveX" cnnid="about:blank" />
                    <node name="eclipse" caption="Tangram for Eclipse" id="ClrCtrl" cnnid="tangramdotnetlib.EclipsePlusCtrl, tangramdotnetlib, version=1.0.0.0, culture=neutral, publickeytoken=90f9467f8999d660" />
                </node>
            </window>
        </tangramdesignertoolbar>
    </xml>
    <xml id="xtmlExcelToolBar">
        <tangramdesignertoolbar>
            <window>
                <node id="splitter" name="splitter" caption="Tangram Designer" style="0" rows="2" cols="1" height="550,250," width="500," middlecolor="RGB(255,224,192)">
                    <node name="TangramToolPane1" id="TangramTabCtrl" cnnid="TangramTabbedWnd.TabbedComponent.1" style="18" activepage="0">
                        <node name="howto" id="ClrCtrl" cnnid="TangramDesigner.StartupCtrl,TangramCLR" caption="Excel Designer: How to......" />
                        <node name="hostview" id="ClrCtrl" cnnid="TangramDesigner.HostViewDesigner,TangramCLR" caption="Excel Sheet" />
                        <node name="splitter" id="ClrCtrl" cnnid="TangramDesigner.SplitterDesigner,TangramCLR" caption="Create Splitter Window" />
                        <node name="tabbedwnd" id="ClrCtrl" cnnid="TangramDesigner.TabWndDesigner,TangramCLR" caption="Create Tabbed Window" />
                        <node name="axctrl" id="ClrCtrl" cnnid="TangramDesigner.AXCtrlDesigner,TangramCLR" caption="Create ActiveX Controls" />
                        <node name="clrctrl" id="ClrCtrl" cnnid="TangramDesigner.CLRCtrlDesigner,TangramCLR" caption="Create .NET Controls" />
                        <node name="cpp" id="ClrCtrl" cnnid="TangramDesigner.CppDesigner,TangramCLR" caption="C++ Components" />
                        <node name="TangramEditor" id="TreeView" SetHtml="1" doctype="designer" tag="designer" caption="Tangram DOM Model">
                            <TreeNode />
                        </node>
                    </node>
                    <node name="TangramToolPane2" id="TangramTabCtrl" cnnid="TangramTabbedWnd.TabbedComponent.1" style="18">
                        <node name="TangramPropertyGrid" caption="Property Editor" id="ClrCtrl" cnnid="system.windows.forms.propertygrid,tangram" />
                    </node>
                </node>
            </window>
        </tangramdesignertoolbar>
    </xml>
    <xml id="xtmlOutLookToolBar">
        <tangramdesignertoolbar>
            <window>
                <node id="splitter" name="splitter" caption="Tangram Designer" style="0" rows="2" cols="1" height="550,250," width="500," middlecolor="RGB(255,224,192)">
                    <node name="TangramToolPane1" id="TangramTabCtrl" cnnid="TangramTabbedWnd.TabbedComponent.1" style="18" activepage="0">
                        <node name="howto" id="ClrCtrl" cnnid="TangramDesigner.StartupCtrl,TangramCLR" caption="OutLook Designer: How to......" />
                        <node name="hostview" id="ClrCtrl" cnnid="TangramDesigner.HostViewDesigner,TangramCLR" caption="Create Host View" />
                        <node name="splitter" id="ClrCtrl" cnnid="TangramDesigner.SplitterDesigner,TangramCLR" caption="Create Splitter Window" />
                        <node name="tabbedwnd" id="ClrCtrl" cnnid="TangramDesigner.TabWndDesigner,TangramCLR" caption="Create Tabbed Window" />
                        <node name="axctrl" id="ClrCtrl" cnnid="TangramDesigner.AXCtrlDesigner,TangramCLR" caption="Create ActiveX Controls" />
                        <node name="clrctrl" id="ClrCtrl" cnnid="TangramDesigner.CLRCtrlDesigner,TangramCLR" caption="Create .NET Controls" />
                        <node name="cpp" id="ClrCtrl" cnnid="TangramDesigner.CppDesigner,TangramCLR" caption="C++ Components" />
                        <node name="TangramEditor" id="TreeView" SetHtml="1" doctype="designer" tag="designer" caption="Tangram DOM Model">
                            <TreeNode />
                        </node>
                    </node>
                    <node name="TangramToolPane2" id="TangramTabCtrl" cnnid="TangramTabbedWnd.TabbedComponent.1" style="18">
                        <node name="TangramPropertyGrid" caption="Property Editor" id="ClrCtrl" cnnid="system.windows.forms.propertygrid,tangram" />
                    </node>
                </node>
            </window>
        </tangramdesignertoolbar>
    </xml>
    <xml id="xtmlWinWordToolBar">
        <tangramdesignertoolbar>
            <window>
                <node id="splitter" name="splitter" caption="Tangram Designer" style="0" rows="2" cols="1" height="550,250," width="500," middlecolor="RGB(255,224,192)">
                    <node name="TangramToolPane1" id="TangramTabCtrl" cnnid="TangramTabbedWnd.TabbedComponent.1" style="18" activepage="0">
                        <node name="howto" id="ClrCtrl" cnnid="TangramDesigner.StartupCtrl,TangramCLR" caption="WinWord Designer: How to......" />
                        <node name="hostview" id="ClrCtrl" cnnid="TangramDesigner.HostViewDesigner,TangramCLR" caption="Create Host View" />
                        <node name="splitter" id="ClrCtrl" cnnid="TangramDesigner.SplitterDesigner,TangramCLR" caption="Create Splitter Window" />
                        <node name="tabbedwnd" id="ClrCtrl" cnnid="TangramDesigner.TabWndDesigner,TangramCLR" caption="Create Tabbed Window" />
                        <node name="axctrl" id="ClrCtrl" cnnid="TangramDesigner.AXCtrlDesigner,TangramCLR" caption="Create ActiveX Controls" />
                        <node name="clrctrl" id="ClrCtrl" cnnid="TangramDesigner.CLRCtrlDesigner,TangramCLR" caption="Create .NET Controls" />
                        <node name="cpp" id="ClrCtrl" cnnid="TangramDesigner.CppDesigner,TangramCLR" caption="C++ Components" />
                        <node name="TangramEditor" id="TreeView" SetHtml="1" doctype="designer" tag="designer" caption="Tangram DOM Model">
                            <TreeNode />
                        </node>
                    </node>
                    <node name="TangramToolPane2" id="TangramTabCtrl" cnnid="TangramTabbedWnd.TabbedComponent.1" style="18">
                        <node name="TangramPropertyGrid" caption="Property Editor" id="ClrCtrl" cnnid="system.windows.forms.propertygrid,tangram" />
                    </node>
                </node>
            </window>
        </tangramdesignertoolbar>
    </xml>
</body>
</html>